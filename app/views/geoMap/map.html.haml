- content_for :title, 'Map'

- content_for :scripts do
  = javascript_include_tag 'map'
  %script{:src => "//maps.google.com/maps/api/js", :type => "text/javascript"}
  = yield :scripts
%div.panel.panel-default
  %div.panel-body

    #map{:style => 'width: 70%; height: 510px; padding: 10px;'}

    %br

    %table.table.table-bordered{:style => 'width: 70%;'}
      %tr
        %th Title:
        %td#title
          -#TODO this will be where the url will go, implement like below.
          %a{:href => "media/"}

      %tr
        %th Date:
        %td#date

      %tr
        %th Location:
        %td#location

      %tr
        %th Type:
        %td#type
    -#this div is for the javascript to submit a form to the controller
    %div.hidden
      = form_tag(map_path, method: "post") do
        .form-group.form-inline
          = text_field_tag(:lat, params[:lat], :class => "form-control")
          = text_field_tag(:lng, params[:lat], :class => "form-control")
          = submit_tag("Search", :class => "btn btn-default" )




:javascript
    $(document).ready( function() {
      map = new GMaps({
          el: '#map',
          lat: 53.452,
          lng: -1.212,
          zoom: 13,
      });

      //This adds listeners to each marker

      var markers = map.addMarkers(#{raw @lat_lng.to_json});
      for (i = 0; i < markers.length; i++) {
        //This adds listeners to each marker so that they perform
        //an action on clicking them.
        markers[i].addListener('click', function(evt) {
          //TODO ADD ON CLICK HERE!!!
          console.log(this.position.lat());
          var lat = this.position.lat();
          var lng = this.position.lng();
          $('#title').empty();
          $('#date').empty();
          $('#location').empty();
          $('#type').empty();
          var title = document.createElement('div');
          var date = document.createElement('div');
          date.innerHTML = "bants";
          var location = document.createElement('div');
          location.innerHTML = "bants";
          var type = document.createElement('div');
          type.innerHTML = "bants";
          $('#title').html(title);
          $('#date').html(date);
          $('#location').html(location);
          $('#type').html(type);
        });
      }
    });


