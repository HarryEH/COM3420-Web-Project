- content_for :scripts do
  = javascript_include_tag 'map'
  = javascript_include_tag 'media'
  %script{:src => "//maps.google.com/maps/api/js", :type => "text/javascript"}
    = yield :scripts

.row
  .col-md-6
    = form_tag(medium_url,  :method=>'get') do
      Edit History
      - if mod_signed_in?
        = select_tag 'record_id', options_for_select(@medium.all_records.reverse.collect {|a| [a.to_s_mod , a.id]},  @current_record.id)
      - else
        = select_tag 'record_id', options_for_select(@medium.approved_records.reverse.collect {|a| [a.to_s , a.id]},  @current_record.id)
      = submit_tag 'View', name: nil
  - # Only the latest record can be edified to reduce conflicts
  - if @current_record == @medium.latest_approved_record
    .col-md-6
      = link_to 'Edit', edit_medium_path, {class: 'btn btn-warning pull-right'}

  %br

    -#TODO someone needs to put this in a better place (ie make it look decent)
    %button.btn.btn-info.btn-lg{'data-target' => '#myModal', 'data-toggle' => 'modal', :type => 'button', :style=>'font-size:14px'}
      Report
    / Modal
    #myModal.modal.fade{:role => "dialog"}
      .modal-dialog
        / Modal content
        .modal-content
          .modal-header
            %button.close{"data-dismiss" => "modal", :type => "button"} Ã—
            %h4.modal-title Report
          .modal-body
            -#TODO add the form in here!
            = form_tag(media_path, method: "get", :id =>'form_id') do
              Title:
              =@current_record.title
              %p
                Name:
              = text_field_tag(:name, params[:name], :class => "form-control", :style=>'padding:5px')
              Email:
              = text_field_tag(:email, params[:email], :class => "form-control", :style=>'padding:5px')
              Issue:
              = text_field_tag(:issue, params[:issue], :class => "form-control", :style=>'padding:5px; height: 45px')
              %br
              = recaptcha_tags
              %br
              = submit_tag('Send', :class => "btn btn-default", :id => 'Send')
          .modal-footer
            %button.btn.btn-default{"data-dismiss" => "modal", :type => "button"} Close

    %br

- if mod_signed_in?
  %br
  .row
    .col-md-12
      = form_tag(approve_medium_url,  :method=>'get') do
        = hidden_field_tag :record_id, @current_record.id
        - unless @current_record.approved?
          = submit_tag 'Approve Edit', name: 'approve', class: 'btn btn-primary'
        = submit_tag 'Remove Edit', name: 'remove', class: 'btn btn-danger pull-right'

%br
%div.panel.panel-default
  %div.panel-body.record
    .row
      .col-md-4.col-sm-6
        %h2 #{@current_record.title}
      .col-md-3.col-sm-6.date.pull-right
        #{@current_record.ref_date.to_formatted_s(:long) if @current_record.ref_date?}
    .row
      .col-md-6.col-sm-12
        #{@current_record.description}
    %br
    .row
      - if @medium.class.name == 'Recording'
        .col-md-6
          %audio{:src => @medium.upload.url, :type => 'audio/wav', :preload => 'auto'}
          :javascript
            audiojs.events.ready(function() {
              var as = audiojs.createAll();
            });
      - elsif @medium.class.name == 'Document'
        .col-md-12
          %object{:data => @medium.upload.url}
      - elsif @medium.class.name == 'Text'
        .col-md-12
          #{File.read(@medium.upload.path)}
      - elsif @medium.class.name == 'Image'
        .col-md-8
          %img{:src => @medium.upload.url, :height => '500px'}

    - unless @medium.transcript.nil?
      .row
        .col-md-12
          %object{:data => @medium.transcript.url, :height => '300px'}
    .ui-content{"data-role" => "main"}



    - if @current_record.latitude?
      %br
      #map-container.row.col-md-5.col-sm-12
        #map{:style => 'height: 250px;'}
      :javascript
        //This is the map declaration, with the center and zoom etc.
        //It is unlikely that changes will need to be made here.
        map = new GMaps({
          el: '#map',
          lat: 53.452,
          lng: -1.212,
          zoom: 13,
        });

        var latlng = new google.maps.LatLng(parseFloat("#{@current_record.latitude}"),parseFloat("#{@current_record.longitude}"));
        map.addMarker({position:latlng});
    - if @current_record.location?
      .row.col-md-12
        #{@current_record.location}
